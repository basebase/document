#### 线段树(Segment Tree)


##### 什么是线段树?

###### 为什么使用线段树
对于一类问题, 我们关心的是线段(或者区间)。

比如一个经典例子: 区间染色(如图1-1)

有一面墙, 长度为n, 每次选择一段墙进行染色。  
m次操作后, 我们可以看到多少种颜色?  
m次操作后, 我们可以在[i...j]区间内看到多少种颜色?

在这里, 染色操作就是我们的更新区间操作, 更新成了新的颜色。  
我们在[i...j]这个区间查看有多少种颜色, 这就是查询操作。

上述问题可以通过数组来完成, 但是更新和查询的时间都是O(n)级别的, 显然这个性能是不够的。 由于我们只关注某一个区间, 此时线段树就可以派上用场了。


图1-1
 ![1-1](https://github.com/basebase/img_server/blob/master/common/segment01.png?raw=true)


另一类经典问题: 区间查询(如图1-2)

之前我们都是针对单个元素进行插入、删除或者是更新操作。  
但是, 我们有些时候希望对一个区间内的所有数据进行统计查询。  
查询一个区间[i...j]的最大值, 最小值或者区间数字总和。(这就是基于一个区间的统计查询)

如: 我们现在要统计2017年注册用户截止当前消费最高的用户?消费最小的用户?


上述问题也可以使用数组来实现, 不过复杂度都是O(n)级别, 但是如果使用线段树的话则是O(logn)


图1-2
 ![1-1](https://github.com/basebase/img_server/blob/master/common/segment02.png?raw=true)


线段树解决以下问题:
  对于给定的区间
  1. 更新: 更新区间中一个元素或者一个区间的值
  2. 查询: 查询一个区间[i...j]的最大值, 最小值, 或者区间数字和。
